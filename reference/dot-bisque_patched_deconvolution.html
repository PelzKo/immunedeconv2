<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Calculates the decomposition using the bisque algorithm — .bisque_patched_deconvolution • omnideconv</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Calculates the decomposition using the bisque algorithm — .bisque_patched_deconvolution"><meta property="og:description" content="Generates a reference profile based on single-cell data. Learns a
transformation of bulk expression based  on  observed  single-cell
proportions  and  performs  NNLS  regression  on  these  transformed
values to estimate cell proportions."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">omnideconv</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/omnideconv_vignette.html">Omnideconv Overview</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/omnideconv/omnideconv/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculates the decomposition using the bisque algorithm</h1>
    <small class="dont-index">Source: <a href="https://github.com/omnideconv/omnideconv/blob/HEAD/R/bisque.R" class="external-link"><code>R/bisque.R</code></a></small>
    <div class="hidden name"><code>dot-bisque_patched_deconvolution.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Generates a reference profile based on single-cell data. Learns a
transformation of bulk expression based  on  observed  single-cell
proportions  and  performs  NNLS  regression  on  these  transformed
values to estimate cell proportions.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">.bisque_patched_deconvolution</span><span class="op">(</span></span>
<span>  <span class="va">bulk_gene_expression</span>,</span>
<span>  <span class="va">signature</span>,</span>
<span>  <span class="va">single_cell_object</span>,</span>
<span>  <span class="va">cell_type_annotations</span>,</span>
<span>  <span class="va">batch_ids</span>,</span>
<span>  markers <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cell_types <span class="op">=</span> <span class="st">"cellType"</span>,</span>
<span>  subject_names <span class="op">=</span> <span class="st">"batchId"</span>,</span>
<span>  use_overlap <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  old_cpm <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>bulk_gene_expression</dt>
<dd><p>A matrix of bulk data. Rows are genes, columns are samples.
Row and column names need to be set.</p></dd>


<dt>signature</dt>
<dd><p>The signature matrix. Rows are genes, columns are cell types.</p></dd>


<dt>single_cell_object</dt>
<dd><p>A matrix with the single-cell data. Rows are genes, columns are
samples. Row and column names need to be set.</p></dd>


<dt>cell_type_annotations</dt>
<dd><p>A vector of the cell type annotations. Has to be in the same order
as the samples in single_cell_object.</p></dd>


<dt>batch_ids</dt>
<dd><p>A vector of the ids of the samples or individuals.</p></dd>


<dt>markers</dt>
<dd><p>Structure, such as character vector, containing marker genes
to be used in decomposition. <code>unique(unlist(markers))</code> should
return a simple vector containing each gene name. If no argument or NULL
provided, the method will use all available genes for decomposition.</p></dd>


<dt>cell_types</dt>
<dd><p>Character string. Name of phenoData attribute in sc.eset
indicating cell type label for each cell.</p></dd>


<dt>subject_names</dt>
<dd><p>Character string. Name of phenoData attribute in sc.eset
indicating individual label for each cell.</p></dd>


<dt>use_overlap</dt>
<dd><p>Boolean. Whether to use and expect overlapping samples
in decomposition.</p></dd>


<dt>verbose</dt>
<dd><p>Whether to produce an output on the console.</p></dd>


<dt>old_cpm</dt>
<dd><p>Prior to version 1.0.4 (updated in July 2020), the package
converted counts to CPM after subsetting the marker genes. Github user
randel pointed out that the order of these operations should be switched.
Thanks randel! This option is provided for replication of older BisqueRNA
but should be enabled, especially for small marker gene sets.
We briefly tested this change on the cortex and adipose datasets.
The original and new order of operations produce estimates that have an
average correlation of 0.87 for the cortex and 0.84 for the adipose within
each cell type.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A list including:</p>
<dl><dt>bulk_props</dt>
<dd><p>A matrix of cell type proportion estimates with cell types as rows and
individuals as columns.</p></dd>

<dt>sc_props</dt>
<dd><p>A matrix of cell type proportions estimated directly from counting single-cell
data.</p></dd>

<dt>rnorm</dt>
<dd><p>Euclidean norm of the residuals for each individual's proportion estimates.</p></dd>

<dt>genes_used</dt>
<dd><p>A vector of genes used in decomposition.</p></dd>

<dt>transformed_bulk</dt>
<dd><p>The transformed bulk expression used for decomposition. These values
are generated by applying a linear transformation to the CPM expression.</p></dd>

</dl></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Konstantin Pelz, Nicolas Goedert, Yuyu Liang, Katharina Reinisch.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.</p>
</div>

      </footer></div>

  


  

  </body></html>

