<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Signature creation with MuSiC. — build_model_music • omnideconv</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Signature creation with MuSiC. — build_model_music"><meta property="og:description" content="MuSiC does the signature creation in one step, not separated into build_model and deconvolute.
Please use the deconvolute method with your single cell and bulk RNA seq data to use MuSiC."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">omnideconv</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/omnideconv_example.html">Deconvolution of the tumor microenvironment with omnideconv</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/omnideconv/omnideconv/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Signature creation with MuSiC.</h1>
    <small class="dont-index">Source: <a href="https://github.com/omnideconv/omnideconv/blob/main/R/MuSiC.R" class="external-link"><code>R/MuSiC.R</code></a></small>
    <div class="hidden name"><code>build_model_music.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>MuSiC does the signature creation in one step, not separated into build_model and deconvolute.
Please use the deconvolute method with your single cell and bulk RNA seq data to use MuSiC.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">build_model_music</span><span class="op">(</span></span>
<span>  <span class="va">single_cell_object</span>,</span>
<span>  <span class="va">cell_type_annotations</span>,</span>
<span>  <span class="va">batch_ids</span>,</span>
<span>  non_zero <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  markers <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  clusters <span class="op">=</span> <span class="st">"cellType"</span>,</span>
<span>  samples <span class="op">=</span> <span class="st">"batchId"</span>,</span>
<span>  select_ct <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cell_size <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ct_cov <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-single-cell-object">single_cell_object<a class="anchor" aria-label="anchor" href="#arg-single-cell-object"></a></dt>
<dd><p>A matrix with the single-cell data. Rows are genes, columns are
samples. Row and column names need to be set.</p></dd>


<dt id="arg-cell-type-annotations">cell_type_annotations<a class="anchor" aria-label="anchor" href="#arg-cell-type-annotations"></a></dt>
<dd><p>A vector of the cell type annotations. Has to
be in the same order as the samples in single_cell_object.</p></dd>


<dt id="arg-batch-ids">batch_ids<a class="anchor" aria-label="anchor" href="#arg-batch-ids"></a></dt>
<dd><p>A vector of the ids of the samples or individuals.</p></dd>


<dt id="arg-non-zero">non_zero<a class="anchor" aria-label="anchor" href="#arg-non-zero"></a></dt>
<dd><p>logical, default as TRUE. If true, remove all gene with zero expression.</p></dd>


<dt id="arg-markers">markers<a class="anchor" aria-label="anchor" href="#arg-markers"></a></dt>
<dd><p>vector or list of gene names, default as NULL. If NULL, use all genes.</p></dd>


<dt id="arg-clusters">clusters<a class="anchor" aria-label="anchor" href="#arg-clusters"></a></dt>
<dd><p>character, the name of the phenoData of the single cell dataset used as clusters.</p></dd>


<dt id="arg-samples">samples<a class="anchor" aria-label="anchor" href="#arg-samples"></a></dt>
<dd><p>character, the name of the phenoData of the single cell dataset used as samples.</p></dd>


<dt id="arg-select-ct">select_ct<a class="anchor" aria-label="anchor" href="#arg-select-ct"></a></dt>
<dd><p>vector of cell types. Default as NULL. If NULL, then use all cell types
provided.</p></dd>


<dt id="arg-cell-size">cell_size<a class="anchor" aria-label="anchor" href="#arg-cell-size"></a></dt>
<dd><p>data.frame of cell sizes. 1st column contains the names of cell types, 2nd
column has the cell sizes per cell type. Default as NULL. If NULL, then estimate cell size
from data.</p></dd>


<dt id="arg-ct-cov">ct_cov<a class="anchor" aria-label="anchor" href="#arg-ct-cov"></a></dt>
<dd><p>logical. If TRUE, use the covariance across cell types.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Whether to produce an output on the console.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>a list with elements:</p><ul><li><p>gene by cell type matrix of Design matrix</p></li>
<li><p>subject by celltype matrix of Library size</p></li>
<li><p>vector of average library size for each cell type</p></li>
<li><p>gene by celltype matrix of average relative abundance</p></li>
<li><p>gene by celltype matrix of cross-subject variation</p></li>
</ul></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Lorenzo Merotto, Alexander Dietrich, Konstantin Pelz, Nicolas Goedert, Yuyu Liang, Katharina Reinisch.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

